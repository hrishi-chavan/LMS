<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Hotel Menu</title>
  
  <!-- Materialize CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet"/>
  <!-- Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
  <!-- Animate.css for transitions -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

  <style>
    body {
      background: #fafafa;
      overflow-x: hidden;
    }
    .menu-item img { border-radius: 8px; }
    .page {
      display: none;
      opacity: 0;
      position: relative;
      animation-duration: 0.5s;
      height: calc(100vh - 80px);
    }
    .page.active {
      display: block;
      opacity: 1;
      animation-name: fadeInRight;
    }
    .fixed-action-btn { bottom: 23px; }

    /* Confirmation Modal Styling */
    #confirmModal .modal-content { text-align: center; }
    #confirmIcon { font-size: 48px; margin-bottom: 10px; }
    .confirm-red #confirmIcon { color: #e53935; }
    .confirm-orange #confirmIcon { color: #fb8c00; }
    .confirm-teal #confirmIcon { color: #009688; }

    /* Animation keyframes for page transitions */
    @keyframes fadeInRight {
      from { transform: translateX(40px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    @keyframes fadeOutLeft {
      from { transform: translateX(0); opacity: 1; }
      to { transform: translateX(-40px); opacity: 0; }
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <nav class="teal">
    <div class="nav-wrapper">
      <a href="#!" class="brand-logo center">Hotel Menu</a>
    </div>
  </nav>

  <!-- ===== WELCOME PAGE ===== -->
  <div id="welcomePage" class="page active container center animate__animated animate__fadeIn">
    <h5>Welcome to Our Hotel</h5>
    <p>Please enter your details to continue</p>
    <form id="userForm" class="col s12" style="max-width:400px;margin:auto;">
      <div class="input-field">
        <input id="userName" type="text" required>
        <label for="userName">Full Name</label>
      </div>
      <div class="input-field">
        <input id="userTable" type="text" required>
        <label for="userTable">Table Number</label>
      </div>
      <button type="submit" class="btn waves-effect teal">Continue</button>
    </form>
  </div>

  <!-- ===== MENU PAGE ===== -->
  <div id="menuPage" class="page container">
    <h5 class="center">Our Dishes</h5>
    <ul class="collection animate__animated animate__fadeInUp">
      <li class="collection-item avatar menu-item" onclick="showDetail('pasta')">
        <img src="https://img.freepik.com/premium-photo/classic-italian-pasta-penne-parmesan-cheese-dark-table-penne-pasta-with-sauce-top-view-generative-ai_47243-2249.jpg" alt="" class="circle">
        <span class="title"><b>Creamy Alfredo Pasta</b></span>
        <p>Rich and creamy white sauce<br>₹450</p>
        <a href="#!" class="secondary-content"><i class="material-icons">chevron_right</i></a>
      </li>
      <li class="collection-item avatar menu-item" onclick="showDetail('pizza')">
        <img src="https://cdn.pixabay.com/photo/2024/04/18/10/41/ai-generated-8704060_1280.jpg" alt="" class="circle">
        <span class="title"><b>Margherita Pizza</b></span>
        <p>Classic cheese and basil<br>₹500</p>
        <a href="#!" class="secondary-content"><i class="material-icons">chevron_right</i></a>
      </li>
    </ul>

    <!-- FAB -->
    <div class="fixed-action-btn">
      <a class="btn-floating btn-large teal">
        <i class="large material-icons">menu</i>
      </a>
      <ul>
        <li><a class="btn-floating red" onclick="showOrderList()"><i class="material-icons">receipt</i></a></li>
        <li><a class="btn-floating orange" onclick="openConfirmModal('changeUser')"><i class="material-icons">person</i></a></li>
      </ul>
    </div>
  </div>

  <!-- ===== DETAIL PAGE ===== -->
  <div id="detailPage" class="page container">
    <a href="#!" onclick="showPage(pages.menu)" class="btn-flat"><i class="material-icons left">arrow_back</i>Back</a>
    <div id="detailContent"></div>
  </div>

  <!-- ===== ORDER PAGE ===== -->
  <div id="orderPage" class="page container">
    <a href="#!" onclick="showPage(pages.detail)" class="btn-flat"><i class="material-icons left">arrow_back</i>Back</a>
    <h5>Place Your Order</h5>
    <form id="orderForm">
      <div class="input-field">
        <input id="quantity" type="number" value="1" min="1" required>
        <label for="quantity">Quantity</label>
      </div>
      <div class="input-field">
        <textarea id="notes" class="materialize-textarea"></textarea>
        <label for="notes">Special Instructions</label>
      </div>
      <button type="submit" class="btn waves-effect waves-light teal">Confirm Order</button>
    </form>
  </div>

  <!-- ===== ORDER LIST PAGE ===== -->
  <div id="orderListPage" class="page container">
    <a href="#!" onclick="showPage(pages.menu)" class="btn-flat"><i class="material-icons left">arrow_back</i>Back</a>
    <h5>My Orders</h5>
    <ul id="orderList" class="collection"></ul>
    <div id="grandTotalCard" class="card-panel teal lighten-5 center-align">
      <h6><b>Grand Total:</b> ₹<span id="grandTotal">0</span></h6>
    </div>
    <div class="center">
      <button class="btn red" onclick="openConfirmModal('clearOrders')"><i class="material-icons left">delete</i>Clear All Orders</button>
    </div>
  </div>

  <!-- ===== ORDER DETAIL MODAL ===== -->
  <div id="orderDetailModal" class="modal">
    <div class="modal-content">
      <h5 id="modalDishName"></h5>
      <ul class="collection">
        <li class="collection-item"><b>Customer:</b> <span id="modalCustomer"></span></li>
        <li class="collection-item"><b>Table:</b> <span id="modalTable"></span></li>
        <li class="collection-item"><b>Quantity:</b> <span id="modalQty"></span></li>
        <li class="collection-item"><b>Price per item:</b> ₹<span id="modalPrice"></span></li>
        <li class="collection-item"><b>Total:</b> ₹<span id="modalTotal"></span></li>
        <li class="collection-item"><b>Special Notes:</b> <span id="modalNotes"></span></li>
        <li class="collection-item"><b>Ordered At:</b> <span id="modalTime"></span></li>
      </ul>
    </div>
    <div class="modal-footer">
      <a href="#!" class="btn red left" onclick="openConfirmModal('deleteOrder')"><i class="material-icons left">delete</i>Delete</a>
      <a href="#!" class="modal-close btn teal">Close</a>
    </div>
  </div>

  <!-- ===== CONFIRM MODAL ===== -->
  <div id="confirmModal" class="modal">
    <div class="modal-content" id="confirmModalContent">
      <i id="confirmIcon" class="material-icons">help_outline</i>
      <h5 id="confirmTitle">Confirm Action</h5>
      <p id="confirmMessage">Are you sure?</p>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close btn-flat">Cancel</a>
      <a href="#!" id="confirmYesBtn" class="btn">Yes</a>
    </div>
  </div>

  <!-- ===== JS ===== -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script>
    const pages = {
      welcome: document.getElementById('welcomePage'),
      menu: document.getElementById('menuPage'),
      detail: document.getElementById('detailPage'),
      order: document.getElementById('orderPage'),
      orderList: document.getElementById('orderListPage')
    };

    const details = {
      pasta: { name: 'Creamy Alfredo Pasta', img: 'https://img.freepik.com/premium-photo/classic-italian-pasta-penne-parmesan-cheese-dark-table-penne-pasta-with-sauce-top-view-generative-ai_47243-2249.jpg', price: 450, desc: 'A rich blend of cream, cheese, and herbs tossed with perfectly cooked fettuccine pasta.' },
      pizza: { name: 'Margherita Pizza', img: 'https://cdn.pixabay.com/photo/2024/04/18/10/41/ai-generated-8704060_1280.jpg', price: 500, desc: 'A timeless Italian classic topped with mozzarella, fresh basil, and tomato sauce.' }
    };

    let orders = JSON.parse(localStorage.getItem('orders')) || [];
    let user = JSON.parse(localStorage.getItem('user')) || null;
    let currentOrderIndex = null;

    function saveOrders() { localStorage.setItem('orders', JSON.stringify(orders)); }

    // Animated page change
    function showPage(page) {
      Object.values(pages).forEach(p => {
        if (p.classList.contains('active')) {
          p.style.animation = 'fadeOutLeft 0.4s forwards';
          setTimeout(() => { p.classList.remove('active'); }, 300);
        }
      });
      setTimeout(() => {
        page.classList.add('active');
        page.style.animation = 'fadeInRight 0.4s forwards';
      }, 300);
    }

    document.getElementById('userForm').addEventListener('submit', e => {
      e.preventDefault();
      user = { name: userName.value, table: userTable.value };
      localStorage.setItem('user', JSON.stringify(user));
      M.toast({html: `Welcome ${user.name} (Table ${user.table})`, classes: 'rounded teal'});
      showPage(pages.menu);
    });

    // Confirmation modal
    function openConfirmModal(type) {
      const modal = M.Modal.getInstance(confirmModal);
      const content = document.getElementById('confirmModalContent');
      const icon = document.getElementById('confirmIcon');
      const title = document.getElementById('confirmTitle');
      const msg = document.getElementById('confirmMessage');
      const yesBtn = document.getElementById('confirmYesBtn');
      content.classList.remove('confirm-red','confirm-orange','confirm-teal');
      yesBtn.className = 'btn';

      if (type === 'changeUser') {
        content.classList.add('confirm-orange');
        icon.textContent = 'person';
        title.textContent = 'Change User';
        msg.textContent = 'Do you want to switch to a different customer?';
        yesBtn.classList.add('orange');
        yesBtn.onclick = () => { changeUser(); modal.close(); };
      } else if (type === 'clearOrders') {
        content.classList.add('confirm-red');
        icon.textContent = 'delete_forever';
        title.textContent = 'Clear All Orders';
        msg.textContent = 'Are you sure you want to clear all orders?';
        yesBtn.classList.add('red');
        yesBtn.onclick = () => { clearOrders(); modal.close(); };
      } else if (type === 'deleteOrder') {
        content.classList.add('confirm-red');
        icon.textContent = 'delete';
        title.textContent = 'Delete Order';
        msg.textContent = 'Are you sure you want to delete this order?';
        yesBtn.classList.add('red');
        yesBtn.onclick = () => { deleteOrder(); modal.close(); };
      }
      modal.open();
    }

    function changeUser() {
      localStorage.removeItem('user');
      user = null;
      showPage(pages.welcome);
      M.toast({html: 'User changed. Please re-enter details.', classes: 'rounded orange'});
    }

    function showDetail(item) {
      const d = details[item];
      document.getElementById('detailContent').innerHTML = `
        <div class="card animate__animated animate__fadeInUp">
          <div class="card-image"><img src="${d.img}"><span class="card-title">${d.name}</span></div>
          <div class="card-content"><p>${d.desc}</p><h6><b>Price: ₹${d.price}</b></h6></div>
          <div class="card-action"><a href="#!" onclick="goToOrder('${item}')" class="btn teal">Order Now</a></div>
        </div>`;
      showPage(pages.detail);
    }

    function goToOrder(itemKey) {
      const item = details[itemKey];
      showPage(pages.order);
      orderForm.onsubmit = e => {
        e.preventDefault();
        const qty = parseInt(quantity.value);
        const notesVal = notes.value;
        const order = { dish: item.name, qty, price: item.price, total: item.price * qty, customer: user.name, table: user.table, notes: notesVal, time: new Date().toLocaleString() };
        orders.push(order);
        saveOrders();
        M.toast({html: `Order placed for ${qty} × ${item.name} (₹${order.total})`, classes: 'rounded teal'});
        orderForm.reset();
        showPage(pages.menu);
      };
    }

    function showOrderList() {
      showPage(pages.orderList);
      const list = document.getElementById('orderList');
      const grandTotalEl = document.getElementById('grandTotal');
      list.innerHTML = '';
      if (!orders.length) { list.innerHTML = '<li class="collection-item center grey-text">No orders yet.</li>'; grandTotalEl.textContent = 0; return; }
      let total = 0;
      orders.forEach((o,i) => {
        total += o.total;
        list.innerHTML += `
          <li class="collection-item avatar animate__animated animate__fadeInUp" onclick="showOrderDetail(${i})">
            <i class="material-icons circle teal">restaurant</i>
            <span class="title"><b>${o.dish}</b></span>
            <p>Qty: ${o.qty} | ₹${o.price} each<br>Table: ${o.table} | ${o.time}</p>
            <span class="secondary-content">₹${o.total}</span>
          </li>`;
      });
      grandTotalEl.textContent = total;
    }

    function showOrderDetail(i) {
      const o = orders[i];
      currentOrderIndex = i;
      modalDishName.textContent = o.dish;
      modalCustomer.textContent = o.customer;
      modalTable.textContent = o.table;
      modalQty.textContent = o.qty;
      modalPrice.textContent = o.price;
      modalTotal.textContent = o.total;
      modalNotes.textContent = o.notes || 'None';
      modalTime.textContent = o.time;
      M.Modal.getInstance(orderDetailModal).open();
    }

    function deleteOrder() {
      if (currentOrderIndex !== null) {
        orders.splice(currentOrderIndex, 1);
        saveOrders();
        showOrderList();
        M.toast({html: 'Order deleted', classes: 'rounded red'});
      }
    }

    function clearOrders() {
      orders = [];
      saveOrders();
      showOrderList();
      M.toast({html: 'All orders cleared!', classes: 'rounded red'});
    }

    document.addEventListener('DOMContentLoaded', () => {
      M.Modal.init(document.querySelectorAll('.modal'));
      M.FloatingActionButton.init(document.querySelectorAll('.fixed-action-btn'));
      if (user) showPage(pages.menu);
    });
  </script>
</body>
</html>
